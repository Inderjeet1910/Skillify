<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Payment</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="icon" type="image/png" href="image/icon.png">

    <link rel="stylesheet" href="styles.css">
    <style>
        body {
        background: linear-gradient(135deg, #667eea, #764ba2);
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <div class="payment-container">
        <h3 class="payment-header">Complete Your Purchase</h3>
        <div class="payment-box">
            <strong id="course_header"></strong>
            <br>
            Total Amount: <strong id="amount_display"></strong>
        </div>
        
        <form id="paymentForm">
            <label class="form-label">Choose Payment Method</label>
            <select class="form-select" id="paymentMethod">
                <option value="card">Credit/Debit Card</option>
                <option value="upi">UPI</option>
                <option value="paypal">PayPal</option>
            </select>
            
            <div id="cardSection">
                <i class="icon">ðŸ’³</i>
                <input type="text" class="form-control mb-2" id="cardAmount" placeholder="Enter amount to pay">
                <input type="text" class="form-control" id="cardNumber" placeholder="XXXX XXXX XXXX XXXX">
                <input type="text" class="form-control mt-2" id="expiryDate" placeholder="MM/YY">
                <input type="text" class="form-control mt-2" id="cvv" placeholder="CVV">
            </div>
            
            <div id="upiSection" style="display: none;">
                <i class="icon">ðŸ“±</i>
                <input type="text" class="form-control mb-2" id="upiAmount" placeholder="Enter amount to transfer">
                <input type="text" class="form-control" id="upiId" placeholder="yourname@upi">
            </div>
            
            <div id="paypalSection" style="display: none;">
                <i class="icon">ðŸ’°</i>
                <input type="text" class="form-control mb-2" id="paypalAmount" placeholder="Enter amount to pay">
                <input type="email" class="form-control" id="paypalEmail" placeholder="email@example.com">
            </div>
            
            <button type="submit" class="btn btn-primary mt-4 w-100">Pay Now</button>
        </form>
    </div>
    
    <script>
        document.getElementById("amount_display").innerHTML=localStorage.getItem("price");
        document.getElementById("course_header").innerHTML=localStorage.getItem("selected_course");
        const paymentMethod = document.getElementById("paymentMethod");
        const sections = { card: "cardSection", upi: "upiSection", paypal: "paypalSection" };
        
        paymentMethod.addEventListener("change", function () {
            for (let key in sections) {
                document.getElementById(sections[key]).style.display = "none";
            }
            document.getElementById(sections[this.value]).style.display = "block";
        });

        document.getElementById("paymentForm").addEventListener("submit", function (e) {
            e.preventDefault();
            
            const method = paymentMethod.value;
            const amounts = {
                card: document.getElementById("cardAmount").value,
                upi: document.getElementById("upiAmount").value,
                paypal: document.getElementById("paypalAmount").value
            };
            
            const inputs = {
                card: {
                    number: document.getElementById("cardNumber").value,
                    expiry: document.getElementById("expiryDate").value,
                    cvv: document.getElementById("cvv").value
                },
                upi: { id: document.getElementById("upiId").value },
                paypal: { email: document.getElementById("paypalEmail").value }
            };
            
            const regex = {
                cardNumber: /^\d{16}$/, 
                expiryDate: /^\d{2}\/\d{2}$/, 
                cvv: /^\d{3}$/, 
                upiId: /^[\w.-]+@[\w]+$/, 
                paypalEmail: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/, 
                amount: /^\$\d+/
            };
            const storedPrice = localStorage.getItem("price"); 
            console.log(storedPrice)
            if (amounts[method] !== storedPrice.replace(",","")) {
                alert("Invalid amount.");
                return;
            }

            if (method === "card" && (!regex.cardNumber.test(inputs.card.number) || !regex.expiryDate.test(inputs.card.expiry) || !regex.cvv.test(inputs.card.cvv))) {
                alert("Invalid Card Details.");
                return;
            }
            if (method === "upi" && !regex.upiId.test(inputs.upi.id)) {
                alert("Invalid UPI ID.");
                return;
            }
            if (method === "paypal" && !regex.paypalEmail.test(inputs.paypal.email)) {
                alert("Invalid PayPal Email.");
                return;
            }
            
            alert("Processing " + method.toUpperCase() + " payment...");
            alert("Payment Successful!");
            window.open("success.html","_self")
        });
    </script>
</body>
</html>
